# Как проходит разработка

Помните! При каждом `git rebase` в той или иной форме могут возникнуть конфликты. Необходимо в обязательном порядке проверять их наличие через поиск по всем файлам символов `<<<<` или `>>>>`.

1. Если Вы начали работу над Issue, необходимо:
   1. Зайти на страницу Issue
   2. Нажать на кнопку `Create branch` в меню справа
   3. Будет предложено название в формате `<issuenumber>-<issuename>`
   4. Заменяем `<issuenumber>-` на префикс `feature/` (что-то новое), `hotfix/` (исправление бага) или `improve/` (общий случай, когда переделываем что-то, что уже работает, или дорабатываем небольшой функционал)
   5. Нажимаем `Create branch`
   6. Переходим в консоль; пишем `git fetch -p` (обновляем ссылки на удалённые ветки (git записывает хэши коммитов, которые существуют в удалённом репозитории и создаёт соответствующие ветки), удаляем устаревшие)
   7. Если до этого работали в другой ветке, необходимо сохранить изменения. Если нет возможности сделать временный коммит (`git commit -m "TEMP"`), можно использовать `git stash`

       `git stash` сохранит отслеживаемые изменения в "тайник". stash представляет собой стэк, верхний элемент которого - результат последней команды `git stash`.
       Чтобы вернуть изменения, нужно набрать `git stash apply` или `git stash pop`.
       В первом случае изменения не удалятся с вершины стека, а во втором - удаляются. Безопаснее сначала сделать `git stash apply`,
       а затем просто удалить изменения через `git stash drop`, так как при применении изменений не на той ветке могут возникнуть конфликты. Лучше не использовать `git stash pop`.
       За подробностями обращайтесь в [Раздел документации GIT](https://git-scm.com/docs/git-stash)
   8. Пишем `git checkout <branchname>` (переходим в новую ветку)
2. Правило: создал "отдельный работающий кусочек кода" - закоммить. Коммиты должны отражать небольшие включения в код, что-то вроде "micro-features". Лучше сделать много маленьких коммитов, чем один большой. Подробнее в [Разделе о GIT Commit](./git-commit.md)
3. Вы можете в любой момент сделать `git push`.
4. Когда Вы закончили разработку, сделаете `Pull Request` из Вашей ветки в ветку `master`.
5. Следите за комментариями в `Pull Request`. Комментарии будут относиться либо __к конкретным коммитам__, либо к коду в целом.
6. История коммитов на вашей ветке __не должна__ содержать исправляющих коммитов, которые сделаны __в той же ветке__. То есть, если Вам необходимо исправить изменения, сделанные в коммите А, не нужно создавать для этого коммит Б: вместо этого правьте коммит А через [interactive rebase](git-rebase.md)
7. Когда Вы применили изменения, введите команду `git push --force-with-lease`. Это перепишет историю коммитов в удалённой ветке.

    В случае, если кто-то уже запушил коммиты в ветку до Вас (удалённая ссылка на вершину ветки устарела), выведется ошибка:
    ```
    ! [rejected]        your-branch -> your-branch (stale info)
    ```
    В таком случае необходимо выполнить следующие команды:
    ```bash
    git fetch -p  # обновляем ссылки на удалённые ветки, удаляем несуществующие
    git rebase origin/<branchname>  # перебазируем текущую ветку - подтянем удалённые коммиты (префикс origin/ указывает на удалённую GITHUB-ветку)
    git push --force-with-lease  # повторная отправка
    ```
8. Если Вы пересели за другое устройство, выполните команду:
    ```bash
    git pull --rebase  # alias для команд git fetch и git rebase
    ```
   или
   ```bash
   git pull --rebase -X theirs  # автоматически разрешает конфликты в пользу актуальных в ветке
   ```
   Второй вариант более предпочтительный, так как плодит меньше конфликтов, вследствие чего более надёжный.
   Команда обновляет ссылки на удалённые коммиты и перезаписывает историю текущей ветки.
9. Если за время работы были слиты другие PR'ы, необходимо выполнить команды:
    ```bash
    git fetch -p  # обновляем ссылки
    git rebase origin/master  # перебазируем из основной ветки
    ```
